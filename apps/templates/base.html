<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お薬管理アプリ {% block title %}{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"/>
    <link rel="stylesheet" href="{{ url_for('auth.static', filename='css/style.css') }}"/>
</head>
<body>
    <!-- ナビゲーションを作成する -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-secondary fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">お薬管理アプリ</a>

            <!-- スマホ用のハンバーガーメニュー -->
            <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbar1"
                aria-controls="navbar1"
                aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- ハンバーガーメニュー内に表示 -->
            <div class="collapse navbar-collapse" id="navbar1">
                <!-- navbarの右側 -->
                <ul class="navbar-nav ms-auto">
                    <!-- ログイン時に表示 -->
                    {% if current_user.is_authenticated %}
                        <!-- 各ページのリンクを表示 -->
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('home.home') }}">HOME</a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('home.medicine_register') }}">お薬新規登録</a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('home.medical_examination') }}">処方記録</a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('home.calendar') }}">カレンダー</a>
                        </li>

                        <!-- ユーザ名とログアウトのリンクを表示 -->
                        <div class="dropdown">
                            <a class="btn btn-secondary dropdown-toggle"
                                role="button"
                                id="dropdownMenuLink"
                                data-bs-toggle="dropdown"
                                aria-expanded="false">
                                {{ current_user.user_name }}
                            </a>
                        
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuLink">
                                <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">ログアウト</a></li>
                            </ul>
                        </div>

                    <!-- 非ログイン時に表示 -->
                    {% else %}
                        <!-- トップリンクを表示 -->
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('home.index') }}">トップ</a>
                        </li>
                        <!-- ログインリンクを表示 -->
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('auth.login') }}">ログイン</a>
                        </li>
                        <!-- ユーザー新規登録リンクを表示 -->
                        <li class="nav-item">
                            <a class="btn btn-secondary" href="{{ url_for('auth.signup') }}">ユーザー新規登録</a>
                        </li>
                    {% endif %}

                </ul>
            </div>
        </div>
    </nav>

    <section class="container">
    {% block content %}
    {% endblock %}
    </section>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>